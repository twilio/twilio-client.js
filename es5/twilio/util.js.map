{"version":3,"file":"util.js","sourceRoot":"","sources":["../../lib/twilio/util.js"],"names":[],"mappings":"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","sourcesContent":["/**\n * Exception class.\n * @class\n * @name Exception\n * @exports Exception as Twilio.Exception\n * @memberOf Twilio\n * @param {string} message The exception message\n */\nfunction TwilioException(message) {\n  if (!(this instanceof TwilioException)) {\n    return new TwilioException(message);\n  }\n  this.message = message;\n}\n\n/**\n * Returns the exception message.\n *\n * @return {string} The exception message.\n */\nTwilioException.prototype.toString = function() {\n  return `Twilio.Exception: ${this.message}`;\n};\n\nfunction average(values) {\n  return values && values.length ? values.reduce((t, v) => t + v) / values.length : 0;\n}\n\nfunction difference(lefts, rights, getKey) {\n  getKey = getKey || (a => a);\n  const rightKeys = new Set(rights.map(getKey));\n  return lefts.filter(left => !rightKeys.has(getKey(left)));\n}\n\nfunction isElectron(navigator) {\n  return !!navigator.userAgent.match('Electron');\n}\n\nfunction isChrome(window, navigator) {\n  const isCriOS = !!navigator.userAgent.match('CriOS');\n  const isHeadlessChrome = !!navigator.userAgent.match('HeadlessChrome');\n  const isGoogle = typeof window.chrome !== 'undefined'\n    && navigator.vendor === 'Google Inc.'\n    && navigator.userAgent.indexOf('OPR') === -1\n    && navigator.userAgent.indexOf('Edge') === -1;\n\n  return isCriOS || isElectron(navigator) || isGoogle || isHeadlessChrome;\n}\n\nfunction isFirefox(navigator) {\n  navigator = navigator || (typeof window === 'undefined'\n    ? global.navigator : window.navigator);\n\n  return !!(navigator) && typeof navigator.userAgent === 'string'\n    && /firefox|fxios/i.test(navigator.userAgent);\n}\n\nfunction isLegacyEdge(navigator) {\n  navigator = navigator || (typeof window === 'undefined'\n    ? global.navigator : window.navigator);\n\n  return !!(navigator) && typeof navigator.userAgent === 'string'\n    && /edge\\/\\d+/i.test(navigator.userAgent);\n}\n\nfunction isSafari(navigator) {\n  return !!(navigator.vendor) && navigator.vendor.indexOf('Apple') !== -1\n    && navigator.userAgent\n    && navigator.userAgent.indexOf('CriOS') === -1\n    && navigator.userAgent.indexOf('FxiOS') === -1;\n}\n\nfunction isUnifiedPlanDefault(window, navigator, PeerConnection, RtpTransceiver) {\n  if (typeof window === 'undefined'\n    || typeof navigator === 'undefined'\n    || typeof PeerConnection === 'undefined'\n    || typeof RtpTransceiver === 'undefined'\n    || typeof PeerConnection.prototype === 'undefined'\n    || typeof RtpTransceiver.prototype === 'undefined') {\n    return false;\n  }\n\n  if (isChrome(window, navigator) && PeerConnection.prototype.addTransceiver) {\n    const pc = new PeerConnection();\n    let isUnifiedPlan = true;\n    try {\n      pc.addTransceiver('audio');\n    } catch (e) {\n      isUnifiedPlan = false;\n    }\n    pc.close();\n    return isUnifiedPlan;\n  } else if (isFirefox(navigator)) {\n    return true;\n  } else if (isSafari(navigator)) {\n    return 'currentDirection' in RtpTransceiver.prototype;\n  }\n\n  // Edge currently does not support unified plan.\n  // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/17733189/\n  // https://wpdev.uservoice.com/forums/257854-microsoft-edge-developer/suggestions/34451998-sdp-unified-plan\n\n  return false;\n}\n\nfunction queryToJson(params) {\n  if (!params) {\n    return '';\n  }\n\n  return params.split('&').reduce((output, pair) => {\n    const parts = pair.split('=');\n    const key = parts[0];\n    const value = decodeURIComponent((parts[1] || '').replace(/\\+/g, '%20'));\n\n    if (key) { output[key] = value; }\n    return output;\n  }, { });\n}\n\n/**\n * Map a list to an array of arrays, and return the flattened result.\n * @param {Array<*>|Set<*>|Map<*>} list\n * @param {function(*): Array<*>} [mapFn]\n * @returns Array<*>\n */\nfunction flatMap(list, mapFn) {\n  const listArray = list instanceof Map || list instanceof Set\n    ? Array.from(list.values())\n    : list;\n\n  mapFn = mapFn || (item => item);\n\n  return listArray.reduce((flattened, item) => {\n    const mapped = mapFn(item);\n    return flattened.concat(mapped);\n  }, []);\n}\n\nexports.Exception = TwilioException;\nexports.average = average;\nexports.difference = difference;\nexports.isElectron = isElectron;\nexports.isChrome = isChrome;\nexports.isFirefox = isFirefox;\nexports.isLegacyEdge = isLegacyEdge;\nexports.isSafari = isSafari;\nexports.isUnifiedPlanDefault = isUnifiedPlanDefault;\nexports.queryToJson = queryToJson;\nexports.flatMap = flatMap;\n"]}